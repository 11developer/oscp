# About the vulnerability 
~~~
Redirects are a useful function to have when building a website. If a user attempts to access 
a resource before they are logged in, it is conventional to redirect them to the login page, 
put the original URL in a query parameter, and after they have logged in, automatically redirect 
them to their original destination. This type of functionality shows you are putting thought into 
the user experience, and is to be encouraged. However, you need to be sure anywhere you do redirects, 
they are done safely – otherwise you are putting your users in harm’s way by enabling phishing attacks.
~~~
# Example 
~~~ 
 www.example.com?next=http://www.haxxed.com  
 www.example.com?_g=DernKFjelgnne&vid=iguana-party&referrer=email&next=http%3A%2F%2Fwww.haxxed.com 
 Change redirect param 
~~~
# How to find entry points to test?

    Burp Proxy history & Burp Sitemap (look at URLs with parameters)
    Google dorking. E.g: inurl:redirectUrl=http site:target.com
    Functionalities usually associated with redirects:
        Login, Logout, Register & Password reset pages
        Change site language
        Links in emails
    Read JavaScript code
    Bruteforcing
        Look for hidden redirect parameters, for e.g.:
        /redirect?url={payload}&next={payload}&redirect={payload}&redir={payload}&rurl={payload}&redirect_uri={payload}
        /?url={payload}&next={payload}&redirect={payload}&redir={payload}&rurl={payload}&redirect_uri={payload}

# Responses to look for when fuzzing

    HTTP redirect status codes
        300 Multiple Choices
        301 Moved Permanently
        302 Found
        303 See Other
        304 Not Modified
        305 Use Proxy
        307 Temporary Redirect
        308 Permanent Redirect
    Alert box popping up

# Tips

    Try using the same parameter twice: ?next=whitelisted.com&next=google.com
    If periods filtered, use an IPv4 address in decimal notation http://www.geektools.com/geektools-cgi/ipconv.cgi
    Try a double-URL and triple-URL encoded version of payloads
    Try redirecting to an IP address (instead of a domain) using different notations: IPv6, IPv4 in decimal, hex or octal
    For XSS, try replacing alert(1) with prompt(1) & confirm(1)
    If extension checked, try ?image_url={payload}/.jpg
    Try target.com/?redirect_url=.uk (or [any_param]=.uk). If it redirects to target.com.uk, then it’s vulnerable! target.com.uk and target.com are different domains.
    Use /U+e280 RIGHT-TO-LEFT OVERRIDE: https://whitelisted.com@%E2%80%AE@moc.elgoog
        The unicode character U+202E changes all subsequent text to be right-to-left
        E.g.: https://hackerone.com/reports/299403

# Tools

    Burp Intruder & Burp Repeater
    open-redirect-scanner
    Dirsearch with an open redirect payloads list (instead of the default list, or combined)

# Reference 
https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html 
